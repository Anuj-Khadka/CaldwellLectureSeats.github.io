<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>LectureSeats</title>
  <link rel="icon" type="image/x-icon" href="/lecture-seats-256.png">
  <!-- qr code generator amd scammer -->
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
  <!-- md5 -->
  <script src="https://cdn.jsdelivr.net/npm/js-md5@0.7.3/build/md5.min.js"></script>
  <!-- google drive -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client"></script>
  <script src="gdrive.js"></script>
  <!-- photo -->
  <script src="photo.js"></script>
  <!-- firebase init -->
  <script src="firebase.mjs" type="module"></script>
  <!-- login ui -->
  <!-- <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"></script>
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" /> -->
  <!-- stylesheet and icons -->
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>

  <div id="header">
    <a href="#" id="title">Lecture<span class="themeColor">Seats</span></a>
    <span id="user" onclick="showInMain('profile')">
      <img id="userPhoto">
      <span id="userDisplayName"></span>
    </span>
  </div>

  <div id="firebaseui-auth-container" class="hidden">
    <button class="google-button" onclick="signIn()"><img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="letter-size"> Sign in with Google</button>
    <div class="separator"></div>
    <div class="flexrow">
      <i class="material-symbols-outlined large-icon" style="margin:1em">warning</i>
      <div>
        <p>
          This app requires popups to be enabled for signing in with your Google account.
        </p>
        <p class="important">
          Please make sure popups are enabled before proceeding.
        </p>
        <p>
          Additional permissions your instructor may require:
          <ul>
            <li>location sharing</li>
            <li>camera access</li>
            <li>google drive integration</li>
          </ul>
        </p>
      </div>
    </div>
  </div>
  
  <!-- <div id="enableGoogleDriveDiv" class="hidden">
    <button onclick="signInToGoogleAPI()">Enable Google Drive Access</button>
  </div> -->

  <div id="main" class="hidden">

    <div id="sections">
      <select id="semesterSelect"><option disabled selected value>Select Semester</option></select>
      <div id="instructorSections" class="sectionCards hidden" name="Sections I'm teaching">
        <div id="addInstructorSectionBtn" class="sectionCard center" onclick="createNewSection()"><i class="material-icons">add_circle</i></div>
      </div>
      <div id="studentSections" class="sectionCards hidden" name="Sections I'm enrolled in">
        <div id="addStudentSectionBtn" class="sectionCard center" onclick="showAvailableStudentSections()"><i class="material-icons">add_circle</i></div>
      </div>
    </div>

    <div id="addInstructorSection">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div class="menuTitle">Create New Section</div>
      Semester:
      <select id="sectionSemesterSelect"><option disabled selected value></option></select>
      Section Id:
      <input id="sectionIdInput" placeholder="e.g., CS-195-001">
      Additional Id's (i.e., cross-listed; one section id per line):
      <textarea id="sectionCrosslistInput"></textarea>
      Pattern (days/times):
      <input id="sectionPatternInput" placeholder="e.g., TR 8:30AM-9:45AM">
      Room:
      <select id="sectionRoomSelect"><option disabled selected value></option></select>
      Instructors (one instructor per line):
      <textarea id="sectionInstructorInput"></textarea>
      <div>
        <input type="checkbox" id="sectionLocRequiredCheckbox" checked="checked">
        <label for="sectionLocRequiredCheckbox">Location required</label>
      </div>
      <div>
        <input type="checkbox" id="sectionSeatRequiredCheckbox">
        <label for="sectionSeatRequiredCheckbox">Seat code required</label>
      </div>
      <div>
        <input type="checkbox" id="sectionPhotoRequiredCheckbox">
        <label for="sectionPhotoRequiredCheckbox">Photo required</label>
      </div>
      <!-- <div>
        <input type="checkbox" id="allowEnroll"><label for="allowEnroll">Allow students to self-enroll</label>
      </div> -->
      <button id="sectionSubmitBtn">Save Section</button>
      <button id="sectionDeleteBtn" class="hidden">Delete Section</button>
    </div>

    <div id="selectStudentSection">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div class="menuTitle">Select section where you are a student</div>
      <div id="availableStudentSections" class="sectionCards"></div>
    </div>

    <div id="profile">
      <div>
        <div id="email"></div>
        Preferred Name:
        <input id="nameInput">
        <button id="saveNameBtn" class="hidden">Save Name</button>
      </div>
      <button id="logoutBtn" class="big" onclick="signOut()">Sign Out</button>
      <div class="separator"></div>
      <button id="sectionsBtn" class="big" onclick="showInMain('sections')">My Sections</button>
      <div class="separator"></div>
      <!-- for instructors and admins -->
      <button id="allSectionsBtn" class="big hidden" onclick="showInMain('allSections')">All Sections</button>
      <button id="roomsBtn" class="big hidden" onclick="showInMain('rooms')">Rooms</button>
    </div>

    <!-- for instructors and admins -->
    <div id="rooms">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
    </div>

    <div id="allSections">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
    </div>

    <!-- for instructors -->
    <div id="getAttendance">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div>
        <span id="getAttendanceSectionId"></span>
        <span id="getAttendanceCrossListIds"></span>
      </div>
      <div style="display:flex">
        <div id="getAttendanceSectionInfo"></div>
        <i class="material-icons" id="getAttendanceEditBtn" onclick>edit</i>
      </div>
      Attendance passcode:
      <div class="flexrow">
        <input id="getAttendanceClassCodeInput">
        <i class="material-icons" onclick="randomAttendanceClassCodeClick()" id="randomAttendanceClassCodeBtn">autorenew</i>
        <i class="material-icons hidden" onclick="createQRClick()" id="createQRCodeBtn">qr_code</i>
      </div>
      <div id="collectingAttendanceDiv">
        <span id="collectingAttendance">Collect</span>
        attendance for the next
        <span id="minutesToCollectAttendance" contenteditable="true">75.0</span>
        minutes
      </div>
      <button id="collectAttendanceBtn" onclick="collectAttendanceBtnClick()">Start</button>
      <div class="separator"></div>
      <!-- <button onclick="showAttendanceRecord()">Attendance Record</button> -->
      <div class="flexrow">
        <button onclick="attendanceToday()">Attendance today <i class="material-icons">autorenew</i></button>
        <button onclick="attendanceHistory()">Attendance history <i class="material-icons">history</i></button>
      </div>
      <div id="attendances"></div>
      <button class="hidden" id="downloadAttendanceBtn" onclick="downloadAttendanceRecord()">Download Attendance</button>
    </div>

    <div id="QRcode" class="center" onclick="navigateBack()"></div>

    <div id="room">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
    </div>

    <!-- <div id="attendanceRecord">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div id="attendance"></div>
      <button id="downloadAttendanceBtn">Download</button>
    </div> -->

    <!-- for students -->
    <div id="markAttendance">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div id="markAttendanceSectionId"></div>
      <div id="attendanceMarked"></div>
      <label class="required" for="markAttendanceClassCodeInput">Attendance passcode:</label>
      <div class="flexrow w300">
        <input type="password" id="markAttendanceClassCodeInput" class="grow" oninput="checkMissingAttendanceInfo()">
        <i class="material-symbols-outlined" onclick="openQRreader('markAttendanceClassCodeInput')">qr_code_scanner</i>
      </div>
      <label for="markAttendanceSeatCodeInput">Seat code:</label>
      <div class="flexrow w300">
        <input id="markAttendanceSeatCodeInput" class="grow" oninput="checkMissingAttendanceInfo()">
        <i class="material-symbols-outlined" onclick="openQRreader('markAttendanceSeatCodeInput')">barcode_scanner</i>
      </div>
      <label for="selfieImg">Selfie:</label>
      <div>
        <img id="selfieImg" src="user512.png" onclick="showTakeSelfieScreen()">
        <i class="material-icons large-icon" onclick="showTakeSelfieScreen()">add_a_photo</i>
      </div>
      <!-- <button id="takeSelfieBtn"><span class="material-symbols-outlined">photo_camera</span> Take a new selfie...</button> -->
      <label for="markAttendanceLocation">Location:</label>
      <span id="markAttendanceLocation" class="hidden">
        &nbsp;
        <i class="material-symbols-outlined">location_on</i> ✔️
      </span>
      <div id="markAttendanceLocationOff">
        <i class="material-symbols-outlined">location_off</i> ❌
        Please turn on location sharing and refresh.
        <i class="material-icons" onclick="checkMissingAttendanceInfo()" id="randomAttendanceClassCodeBtn">autorenew</i>
      </div>
      <!-- <div class="separator"></div> -->
      <button id="markAttendanceButton" disabled>Mark Attendance</button>
      <div  id="markAttendanceRequirements" class="w300 dashed-border">
        <!-- <i class="material-symbols-outlined large-icon">warning</i>
        Cannot mark attendance. -->
        <!-- <p> -->
          Missing required information:
          <ul id="markAttendanceRequirementsList">
            <li>Attendance passcode</li>
          </ul>
        <!-- </p> -->
        <div class="required footnote">indicates required field</div>
      </div>
      <div class="separator"></div>
      <br>
      <button id="markAttendanceRemoveButton"><i class="material-symbols-outlined">delete</i> Remove <span id="markAttendanceRemoveButtonSectionId"></span> from My Sections</button>
      <br>
    </div>

    <div id="takeSelfie">
      <button onclick="navigateBack()" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      Take new selfie
      <div class="w300 center">
        <div class="selfieContainer">
          <!-- <img src="user512.png" style="width:100%;height:100%;"> -->
          <video id="selfieVideo" width="300" autoplay playsinline></video>
          <canvas id="selfieCanvas" class="hidden"></canvas>
        </div>
        <!-- <i id="selfieUndo" class="material-symbols-outlined hidden">undo</i> -->
      </div>
      <button id="snapPhotoBtn"><span class="material-symbols-outlined">camera</span> Snap photo</button>
      <div class="separator"></div>
      <button id="saveSelfieBtn" onclick="savePhoto()" disabled><i class="material-symbols-outlined">save</i> Save photo to Google Drive</button>
    </div>
  
    <div id="QRreader">
      <button onclick="navigateBack()" id="QRReaderBackButton" class="back"><i class="material-icons">arrow_back_ios</i>Back</button>
      <div id="QRreaderVideo"></div>
    </div>

  </div>


  <div id="accessibility" class="flexcol">
    <i class="material-icons" onclick="changeFontSize(1)">text_increase</i>
    <i class="material-icons" onclick="changeFontSize(-1)">text_decrease</i>
    <i class="material-icons" id="theme-switch" onclick="toggleDarkMode()">light_mode</i>
  </div>

  <div id="loading" class="hidden center">
    <div id="loader"></div>
    <div>Loading...</div>
  </div>

  <div id="toast" class="hidden">
    <!-- <i id="closeToastBtn" class="material-icons top-right" onclick="this.parentElement.classList.add('hidden')">close</i> -->
    <span id="toastMessage"></span>
  </div>
  
</body>
<script src="main.js"></script>
</html>